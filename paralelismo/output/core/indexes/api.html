<!DOCTYPE html>
<html>
<head>
<title>Highlighted Code</title>
</head>
<body>
<div><h2>Gu√≠a de Colores</h2><ul><li><span style="color: red;">Error</span></li><li><span style="color: blue;">Numbers</span></li><li><span style="color: orange;">Operators</span></li><li><span style="color: navy;">Variables</span></li><li><span style="color: olive;">Functions</span></li><li><span style="color: purple;">Reserved</span></li><li><span style="color: green;">String</span></li><li><span style="color: silver;">Comments</span></li><li><span style="color: brown;">Keys_brackets_punctuation</span></li><li><span style="color: black;">Format</span></li></ul></div><hr><pre>
<span style="color: purple;">from</span>&nbsp;<span style="color: navy;">__future__</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">annotations</span><br><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">typing</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">TYPE_CHECKING</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">cast</span><span style="color: brown;">,</span><br><span style="color: brown;">)</span><br><br><span style="color: purple;">import</span>&nbsp;<span style="color: navy;">numpy</span>&nbsp;<span style="color: purple;">as</span>&nbsp;<span style="color: navy;">np</span><br><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">_libs</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">NaT</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">lib</span><span style="color: brown;">,</span><br><span style="color: brown;">)</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">errors</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">InvalidIndexError</span><br><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">dtypes</span><span style="color: brown;">.</span><span style="color: navy;">cast</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">find_common_type</span><br><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">algorithms</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">safe_sort</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">indexes</span><span style="color: brown;">.</span><span style="color: navy;">base</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">Index</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">_new_Index</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">ensure_index</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">ensure_index_from_sequences</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">get_unanimous_names</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">maybe_sequence_to_range</span><span style="color: brown;">,</span><br><span style="color: brown;">)</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">indexes</span><span style="color: brown;">.</span><span style="color: navy;">category</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">CategoricalIndex</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">indexes</span><span style="color: brown;">.</span><span style="color: navy;">datetimes</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">DatetimeIndex</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">indexes</span><span style="color: brown;">.</span><span style="color: navy;">interval</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">IntervalIndex</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">indexes</span><span style="color: brown;">.</span><span style="color: navy;">multi</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">MultiIndex</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">indexes</span><span style="color: brown;">.</span><span style="color: navy;">period</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">PeriodIndex</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">indexes</span><span style="color: brown;">.</span><span style="color: purple;">range</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">RangeIndex</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">indexes</span><span style="color: brown;">.</span><span style="color: navy;">timedeltas</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">TimedeltaIndex</span><br><br><span style="color: purple;">if</span>&nbsp;<span style="color: navy;">TYPE_CHECKING</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">_typing</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">Axis</span><br><br><br><span style="color: navy;">__all__</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: brown;">[</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"Index"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"MultiIndex"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"CategoricalIndex"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"IntervalIndex"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"RangeIndex"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"InvalidIndexError"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"TimedeltaIndex"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"PeriodIndex"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"DatetimeIndex"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"_new_Index"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"NaT"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"ensure_index"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"ensure_index_from_sequences"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"get_objs_combined_axis"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"union_indexes"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"get_unanimous_names"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"all_indexes_same"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"default_index"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"safe_sort_index"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"maybe_sequence_to_range"</span><span style="color: brown;">,</span><br><span style="color: brown;">]</span><br><br><br><span style="color: purple;">def</span>&nbsp;<span style="color: olive;">get_objs_combined_axis</span><span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">objs</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">intersect</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">bool</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: purple;">False</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">axis</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">Axis</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: blue;">0</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">sort</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">bool</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: purple;">True</span><span style="color: brown;">,</span><br><span style="color: brown;">)</span>&nbsp;<span style="color: orange;">-</span><span style="color: orange;">></span>&nbsp;<span style="color: navy;">Index</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">""</span><span style="color: green;">"
    Extract combined index: return intersection or union (depending on the
    value of "</span><span style="color: navy;">intersect</span><span style="color: green;">") of indexes on given axis, or None if all objects
    lack indexes (e.g. they are numpy arrays).

    Parameters
    ----------
    objs : list
        Series or DataFrame objects, may be mix of the two.
    intersect : bool, default False
        If True, calculate the intersection between indexes. Otherwise,
        calculate the union.
    axis : {0 or 'index', 1 or 'outer'}, default 0
        The axis to extract indexes from.
    sort : bool, default True
        Whether the result index should come out sorted or not.

    Returns
    -------
    Index
    "</span><span style="color: green;">""</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">obs_idxes</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: brown;">[</span><span style="color: navy;">obj</span><span style="color: brown;">.</span><span style="color: olive;">_get_axis</span><span style="color: brown;">(</span><span style="color: navy;">axis</span><span style="color: brown;">)</span>&nbsp;<span style="color: purple;">for</span>&nbsp;<span style="color: navy;">obj</span>&nbsp;<span style="color: purple;">in</span>&nbsp;<span style="color: navy;">objs</span><span style="color: brown;">]</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: olive;">_get_combined_index</span><span style="color: brown;">(</span><span style="color: navy;">obs_idxes</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">intersect</span><span style="color: orange;">=</span><span style="color: navy;">intersect</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">sort</span><span style="color: orange;">=</span><span style="color: navy;">sort</span><span style="color: brown;">)</span><br><br><br><span style="color: purple;">def</span>&nbsp;<span style="color: olive;">_get_distinct_objs</span><span style="color: brown;">(</span><span style="color: navy;">objs</span><span style="color: brown;">:</span>&nbsp;<span style="color: olive;">list</span><span style="color: brown;">[</span><span style="color: navy;">Index</span><span style="color: brown;">]</span><span style="color: brown;">)</span>&nbsp;<span style="color: orange;">-</span><span style="color: orange;">></span>&nbsp;<span style="color: olive;">list</span><span style="color: brown;">[</span><span style="color: navy;">Index</span><span style="color: brown;">]</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">""</span><span style="color: green;">"
    Return a list with distinct elements of "</span><span style="color: navy;">objs</span><span style="color: green;">" (different ids).
    Preserves order.
    "</span><span style="color: green;">""</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">ids</span><span style="color: brown;">:</span>&nbsp;<span style="color: olive;">set</span><span style="color: brown;">[</span><span style="color: navy;">int</span><span style="color: brown;">]</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">set</span><span style="color: brown;">(</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">res</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: brown;">[</span><span style="color: brown;">]</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">for</span>&nbsp;<span style="color: navy;">obj</span>&nbsp;<span style="color: purple;">in</span>&nbsp;<span style="color: navy;">objs</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: olive;">id</span><span style="color: brown;">(</span><span style="color: navy;">obj</span><span style="color: brown;">)</span>&nbsp;<span style="color: purple;">not</span>&nbsp;<span style="color: purple;">in</span>&nbsp;<span style="color: navy;">ids</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">ids</span><span style="color: brown;">.</span><span style="color: olive;">add</span><span style="color: brown;">(</span><span style="color: olive;">id</span><span style="color: brown;">(</span><span style="color: navy;">obj</span><span style="color: brown;">)</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">res</span><span style="color: brown;">.</span><span style="color: olive;">append</span><span style="color: brown;">(</span><span style="color: navy;">obj</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">res</span><br><br><br><span style="color: purple;">def</span>&nbsp;<span style="color: olive;">_get_combined_index</span><span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">indexes</span><span style="color: brown;">:</span>&nbsp;<span style="color: olive;">list</span><span style="color: brown;">[</span><span style="color: navy;">Index</span><span style="color: brown;">]</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">intersect</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">bool</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: purple;">False</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">sort</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">bool</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: purple;">False</span><span style="color: brown;">,</span><br><span style="color: brown;">)</span>&nbsp;<span style="color: orange;">-</span><span style="color: orange;">></span>&nbsp;<span style="color: navy;">Index</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">""</span><span style="color: green;">"
    Return the union or intersection of indexes.

    Parameters
    ----------
    indexes : list of Index or list objects
        When intersect=True, do not accept list of lists.
    intersect : bool, default False
        If True, calculate the intersection between indexes. Otherwise,
        calculate the union.
    sort : bool, default False
        Whether the result index should come out sorted or not.

    Returns
    -------
    Index
    "</span><span style="color: green;">""</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># TODO: handle index names!</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">indexes</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">_get_distinct_objs</span><span style="color: brown;">(</span><span style="color: navy;">indexes</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: olive;">len</span><span style="color: brown;">(</span><span style="color: navy;">indexes</span><span style="color: brown;">)</span>&nbsp;<span style="color: orange;">=</span><span style="color: orange;">=</span>&nbsp;<span style="color: blue;">0</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">index</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">Index</span><span style="color: brown;">(</span><span style="color: brown;">[</span><span style="color: brown;">]</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">elif</span>&nbsp;<span style="color: olive;">len</span><span style="color: brown;">(</span><span style="color: navy;">indexes</span><span style="color: brown;">)</span>&nbsp;<span style="color: orange;">=</span><span style="color: orange;">=</span>&nbsp;<span style="color: blue;">1</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">index</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">indexes</span><span style="color: brown;">[</span><span style="color: blue;">0</span><span style="color: brown;">]</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">elif</span>&nbsp;<span style="color: navy;">intersect</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">index</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">indexes</span><span style="color: brown;">[</span><span style="color: blue;">0</span><span style="color: brown;">]</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">for</span>&nbsp;<span style="color: navy;">other</span>&nbsp;<span style="color: purple;">in</span>&nbsp;<span style="color: olive;">indexes</span><span style="color: brown;">[</span><span style="color: blue;">1</span><span style="color: brown;">:</span><span style="color: brown;">]</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">index</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: navy;">index</span><span style="color: brown;">.</span><span style="color: olive;">intersection</span><span style="color: brown;">(</span><span style="color: navy;">other</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">else</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">index</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">union_indexes</span><span style="color: brown;">(</span><span style="color: navy;">indexes</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">sort</span><span style="color: orange;">=</span><span style="color: purple;">False</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">index</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">ensure_index</span><span style="color: brown;">(</span><span style="color: navy;">index</span><span style="color: brown;">)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: navy;">sort</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">index</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">safe_sort_index</span><span style="color: brown;">(</span><span style="color: navy;">index</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">index</span><br><br><br><span style="color: purple;">def</span>&nbsp;<span style="color: olive;">safe_sort_index</span><span style="color: brown;">(</span><span style="color: navy;">index</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">Index</span><span style="color: brown;">)</span>&nbsp;<span style="color: orange;">-</span><span style="color: orange;">></span>&nbsp;<span style="color: navy;">Index</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">""</span><span style="color: green;">"
    Returns the sorted index

    We keep the dtypes and the name attributes.

    Parameters
    ----------
    index : an Index

    Returns
    -------
    Index
    "</span><span style="color: green;">""</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: navy;">index</span><span style="color: brown;">.</span><span style="color: navy;">is_monotonic_increasing</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">index</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">try</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">array_sorted</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">safe_sort</span><span style="color: brown;">(</span><span style="color: navy;">index</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">except</span>&nbsp;<span style="color: purple;">TypeError</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">pass</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">else</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: olive;">isinstance</span><span style="color: brown;">(</span><span style="color: navy;">array_sorted</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">Index</span><span style="color: brown;">)</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">array_sorted</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">array_sorted</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">cast</span><span style="color: brown;">(</span><span style="color: navy;">np</span><span style="color: brown;">.</span><span style="color: navy;">ndarray</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">array_sorted</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: olive;">isinstance</span><span style="color: brown;">(</span><span style="color: navy;">index</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">MultiIndex</span><span style="color: brown;">)</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">index</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: navy;">MultiIndex</span><span style="color: brown;">.</span><span style="color: olive;">from_tuples</span><span style="color: brown;">(</span><span style="color: navy;">array_sorted</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">names</span><span style="color: orange;">=</span><span style="color: navy;">index</span><span style="color: brown;">.</span><span style="color: navy;">names</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">else</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">index</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">Index</span><span style="color: brown;">(</span><span style="color: navy;">array_sorted</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">name</span><span style="color: orange;">=</span><span style="color: navy;">index</span><span style="color: brown;">.</span><span style="color: navy;">name</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">dtype</span><span style="color: orange;">=</span><span style="color: navy;">index</span><span style="color: brown;">.</span><span style="color: navy;">dtype</span><span style="color: brown;">)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">index</span><br><br><br><span style="color: purple;">def</span>&nbsp;<span style="color: olive;">union_indexes</span><span style="color: brown;">(</span><span style="color: navy;">indexes</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">sort</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">bool</span>&nbsp;
</pre></body>
</html>