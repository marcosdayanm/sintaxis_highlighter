<!DOCTYPE html>
<html>
<head>
<title>Highlighted Code</title>
</head>
<body>
<div><h2>Gu√≠a de Colores</h2><ul><li><span style="color: red;">Error</span></li><li><span style="color: blue;">Numbers</span></li><li><span style="color: orange;">Operators</span></li><li><span style="color: navy;">Variables</span></li><li><span style="color: olive;">Functions</span></li><li><span style="color: purple;">Reserved</span></li><li><span style="color: green;">String</span></li><li><span style="color: silver;">Comments</span></li><li><span style="color: brown;">Keys_brackets_punctuation</span></li><li><span style="color: black;">Format</span></li></ul></div><hr><pre>
<span style="color: purple;">from</span>&nbsp;<span style="color: navy;">__future__</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">annotations</span><br><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">functools</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">partial</span><br><span style="color: purple;">import</span>&nbsp;<span style="color: navy;">operator</span><br><span style="color: purple;">import</span>&nbsp;<span style="color: navy;">re</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">typing</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">TYPE_CHECKING</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">Callable</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">Union</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">cast</span><span style="color: brown;">,</span><br><span style="color: brown;">)</span><br><br><span style="color: purple;">import</span>&nbsp;<span style="color: navy;">numpy</span>&nbsp;<span style="color: purple;">as</span>&nbsp;<span style="color: navy;">np</span><br><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">_config</span><span style="color: brown;">.</span><span style="color: navy;">config</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">get_option</span><br><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">_libs</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">lib</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">missing</span>&nbsp;<span style="color: purple;">as</span>&nbsp;<span style="color: navy;">libmissing</span><span style="color: brown;">,</span><br><span style="color: brown;">)</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">compat</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">pa_version_under10p1</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">pa_version_under13p0</span><span style="color: brown;">,</span><br><span style="color: brown;">)</span><br><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">dtypes</span><span style="color: brown;">.</span><span style="color: navy;">common</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">is_bool_dtype</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">is_integer_dtype</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">is_object_dtype</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">is_scalar</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">is_string_dtype</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">pandas_dtype</span><span style="color: brown;">,</span><br><span style="color: brown;">)</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">dtypes</span><span style="color: brown;">.</span><span style="color: navy;">missing</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">isna</span><br><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">arrays</span><span style="color: brown;">.</span><span style="color: navy;">_arrow_string_mixins</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">ArrowStringArrayMixin</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">arrays</span><span style="color: brown;">.</span><span style="color: navy;">arrow</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">ArrowExtensionArray</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">arrays</span><span style="color: brown;">.</span><span style="color: navy;">boolean</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">BooleanDtype</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">arrays</span><span style="color: brown;">.</span><span style="color: navy;">integer</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">Int64Dtype</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">arrays</span><span style="color: brown;">.</span><span style="color: navy;">numeric</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">NumericDtype</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">arrays</span><span style="color: brown;">.</span><span style="color: navy;">string_</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">BaseStringArray</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">StringDtype</span><span style="color: brown;">,</span><br><span style="color: brown;">)</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">ops</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">invalid_comparison</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">strings</span><span style="color: brown;">.</span><span style="color: navy;">object_array</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">ObjectStringArrayMixin</span><br><br><span style="color: purple;">if</span>&nbsp;<span style="color: purple;">not</span>&nbsp;<span style="color: navy;">pa_version_under10p1</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">pyarrow</span>&nbsp;<span style="color: purple;">as</span>&nbsp;<span style="color: navy;">pa</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">pyarrow</span><span style="color: brown;">.</span><span style="color: navy;">compute</span>&nbsp;<span style="color: purple;">as</span>&nbsp;<span style="color: navy;">pc</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">arrays</span><span style="color: brown;">.</span><span style="color: navy;">arrow</span><span style="color: brown;">.</span><span style="color: navy;">_arrow_utils</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">fallback_performancewarning</span><br><br><br><span style="color: purple;">if</span>&nbsp;<span style="color: navy;">TYPE_CHECKING</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">from</span>&nbsp;<span style="color: navy;">collections</span><span style="color: brown;">.</span><span style="color: navy;">abc</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">Sequence</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">_typing</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">ArrayLike</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">AxisInt</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">Dtype</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">Scalar</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">Self</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">npt</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: brown;">)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">dtypes</span><span style="color: brown;">.</span><span style="color: navy;">dtypes</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">ExtensionDtype</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">Series</span><br><br><br><span style="color: navy;">ArrowStringScalarOrNAT</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">Union</span><span style="color: brown;">[</span><span style="color: navy;">str</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">libmissing</span><span style="color: brown;">.</span><span style="color: navy;">NAType</span><span style="color: brown;">]</span><br><br><br><span style="color: purple;">def</span>&nbsp;<span style="color: olive;">_chk_pyarrow_available</span><span style="color: brown;">(</span><span style="color: brown;">)</span>&nbsp;<span style="color: orange;">-</span><span style="color: orange;">></span>&nbsp;<span style="color: purple;">None</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: navy;">pa_version_under10p1</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">msg</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"pyarrow>=10.0.1 is required for PyArrow backed ArrowExtensionArray."</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">raise</span>&nbsp;<span style="color: purple;">ImportError</span><span style="color: brown;">(</span><span style="color: navy;">msg</span><span style="color: brown;">)</span><br><br><br><span style="color: silver;"># TODO: Inherit directly from BaseStringArrayMethods. Currently we inherit from</span><br><span style="color: silver;"># ObjectStringArrayMixin because we want to have the object-dtype based methods as</span><br><span style="color: silver;"># fallback for the ones that pyarrow doesn't yet support</span><br><br><br><span style="color: purple;">class</span>&nbsp;<span style="color: olive;">ArrowStringArray</span><span style="color: brown;">(</span><span style="color: navy;">ObjectStringArrayMixin</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">ArrowExtensionArray</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">BaseStringArray</span><span style="color: brown;">)</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">""</span><span style="color: green;">"
    Extension array for string data in a ``pyarrow.ChunkedArray``.

    .. warning::

       ArrowStringArray is considered experimental. The implementation and
       parts of the API may change without warning.

    Parameters
    ----------
    values : pyarrow.Array or pyarrow.ChunkedArray
        The array of data.

    Attributes
    ----------
    None

    Methods
    -------
    None

    See Also
    --------
    :func:`array`
        The recommended function for creating a ArrowStringArray.
    Series.str
        The string methods are available on Series backed by
        a ArrowStringArray.

    Notes
    -----
    ArrowStringArray returns a BooleanArray for comparison methods.

    Examples
    --------
    >>> pd.array(["</span><span style="color: navy;">This</span>&nbsp;<span style="color: purple;">is</span><span style="color: green;">", "</span><span style="color: navy;">some</span>&nbsp;<span style="color: navy;">text</span><span style="color: green;">", None, "</span><span style="color: navy;">data</span><span style="color: brown;">.</span><span style="color: green;">"], dtype="</span><span style="color: olive;">string</span><span style="color: brown;">[</span><span style="color: navy;">pyarrow</span><span style="color: brown;">]</span><span style="color: green;">")
    <ArrowStringArray>
    ['This is', 'some text', <NA>, 'data.']
    Length: 4, dtype: string
    "</span><span style="color: green;">""</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># error: Incompatible types in assignment (expression has type "StringDtype",</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># base class "ArrowExtensionArray" defined the type as "ArrowDtype")</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">_dtype</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">StringDtype</span>&nbsp;&nbsp;<span style="color: silver;"># type: ignore[assignment]</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">_storage</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"pyarrow"</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">def</span>&nbsp;<span style="color: purple;">__init__</span><span style="color: brown;">(</span><span style="color: navy;">self</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">values</span><span style="color: brown;">)</span>&nbsp;<span style="color: orange;">-</span><span style="color: orange;">></span>&nbsp;<span style="color: purple;">None</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">_chk_pyarrow_available</span><span style="color: brown;">(</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: olive;">isinstance</span><span style="color: brown;">(</span><span style="color: navy;">values</span><span style="color: brown;">,</span>&nbsp;<span style="color: brown;">(</span><span style="color: navy;">pa</span><span style="color: brown;">.</span><span style="color: navy;">Array</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">pa</span><span style="color: brown;">.</span><span style="color: navy;">ChunkedArray</span><span style="color: brown;">)</span><span style="color: brown;">)</span>&nbsp;<span style="color: purple;">and</span>&nbsp;<span style="color: navy;">pa</span><span style="color: brown;">.</span><span style="color: navy;">types</span><span style="color: brown;">.</span><span style="color: olive;">is_string</span><span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">values</span><span style="color: brown;">.</span><span style="color: navy;">type</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: brown;">)</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">values</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: navy;">pc</span><span style="color: brown;">.</span><span style="color: olive;">cast</span><span style="color: brown;">(</span><span style="color: navy;">values</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">pa</span><span style="color: brown;">.</span><span style="color: olive;">large_string</span><span style="color: brown;">(</span><span style="color: brown;">)</span><span style="color: brown;">)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: olive;">super</span><span style="color: brown;">(</span><span style="color: brown;">)</span><span style="color: brown;">.</span><span style="color: purple;">__init__</span><span style="color: brown;">(</span><span style="color: navy;">values</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">self</span><span style="color: brown;">.</span><span style="color: navy;">_dtype</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">StringDtype</span><span style="color: brown;">(</span><span style="color: navy;">storage</span><span style="color: orange;">=</span><span style="color: navy;">self</span><span style="color: brown;">.</span><span style="color: navy;">_storage</span><span style="color: brown;">)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: purple;">not</span>&nbsp;<span style="color: navy;">pa</span><span style="color: brown;">.</span><span style="color: navy;">types</span><span style="color: brown;">.</span><span style="color: olive;">is_large_string</span><span style="color: brown;">(</span><span style="color: navy;">self</span><span style="color: brown;">.</span><span style="color: navy;">_pa_array</span><span style="color: brown;">.</span><span style="color: navy;">type</span><span style="color: brown;">)</span>&nbsp;<span style="color: purple;">and</span>&nbsp;<span style="color: purple;">not</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">pa</span><span style="color: brown;">.</span><span style="color: navy;">types</span><span style="color: brown;">.</span><span style="color: olive;">is_dictionary</span><span style="color: brown;">(</span><span style="color: navy;">self</span><span style="color: brown;">.</span><span style="color: navy;">_pa_array</span><span style="color: brown;">.</span><span style="color: navy;">type</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">and</span>&nbsp;<span style="color: navy;">pa</span><span style="color: brown;">.</span><span style="color: navy;">types</span><span style="color: brown;">.</span><span style="color: olive;">is_large_string</span><span style="color: brown;">(</span><span style="color: navy;">self</span><span style="color: brown;">.</span><span style="color: navy;">_pa_array</span><span style="color: brown;">.</span><span style="color: navy;">type</span><span style="color: brown;">.</span><span style="color: navy;">value_type</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: brown;">)</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">raise</span>&nbsp;<span style="color: purple;">ValueError</span><span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"ArrowStringArray requires a PyArrow (chunked) array of "</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"large_string type"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: brown;">)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;
</pre></body>
</html>