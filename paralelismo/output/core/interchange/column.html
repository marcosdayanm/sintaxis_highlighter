<!DOCTYPE html>
<html>
<head>
<title>Highlighted Code</title>
</head>
<body>
<div><h2>Gu√≠a de Colores</h2><ul><li><span style="color: red;">Error</span></li><li><span style="color: blue;">Numbers</span></li><li><span style="color: orange;">Operators</span></li><li><span style="color: navy;">Variables</span></li><li><span style="color: olive;">Functions</span></li><li><span style="color: purple;">Reserved</span></li><li><span style="color: green;">String</span></li><li><span style="color: silver;">Comments</span></li><li><span style="color: brown;">Keys_brackets_punctuation</span></li><li><span style="color: black;">Format</span></li></ul></div><hr><pre>
<span style="color: purple;">from</span>&nbsp;<span style="color: navy;">__future__</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">annotations</span><br><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">typing</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">TYPE_CHECKING</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">Any</span><span style="color: brown;">,</span><br><span style="color: brown;">)</span><br><br><span style="color: purple;">import</span>&nbsp;<span style="color: navy;">numpy</span>&nbsp;<span style="color: purple;">as</span>&nbsp;<span style="color: navy;">np</span><br><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">_libs</span><span style="color: brown;">.</span><span style="color: navy;">lib</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">infer_dtype</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">_libs</span><span style="color: brown;">.</span><span style="color: navy;">tslibs</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">iNaT</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">errors</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">NoBufferPresent</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">util</span><span style="color: brown;">.</span><span style="color: navy;">_decorators</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">cache_readonly</span><br><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">dtypes</span><span style="color: brown;">.</span><span style="color: navy;">dtypes</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">BaseMaskedDtype</span><br><br><span style="color: purple;">import</span>&nbsp;<span style="color: navy;">pandas</span>&nbsp;<span style="color: purple;">as</span>&nbsp;<span style="color: navy;">pd</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">ArrowDtype</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">DatetimeTZDtype</span><span style="color: brown;">,</span><br><span style="color: brown;">)</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">api</span><span style="color: brown;">.</span><span style="color: navy;">types</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">is_string_dtype</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">interchange</span><span style="color: brown;">.</span><span style="color: navy;">buffer</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">PandasBuffer</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">PandasBufferPyarrow</span><span style="color: brown;">,</span><br><span style="color: brown;">)</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">interchange</span><span style="color: brown;">.</span><span style="color: navy;">dataframe_protocol</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">Column</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">ColumnBuffers</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">ColumnNullType</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">DtypeKind</span><span style="color: brown;">,</span><br><span style="color: brown;">)</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">interchange</span><span style="color: brown;">.</span><span style="color: navy;">utils</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">ArrowCTypes</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">Endianness</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">dtype_to_arrow_c_fmt</span><span style="color: brown;">,</span><br><span style="color: brown;">)</span><br><br><span style="color: purple;">if</span>&nbsp;<span style="color: navy;">TYPE_CHECKING</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">interchange</span><span style="color: brown;">.</span><span style="color: navy;">dataframe_protocol</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">Buffer</span><br><br><span style="color: navy;">_NP_KINDS</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: brown;">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"i"</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">DtypeKind</span><span style="color: brown;">.</span><span style="color: navy;">INT</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"u"</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">DtypeKind</span><span style="color: brown;">.</span><span style="color: navy;">UINT</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"f"</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">DtypeKind</span><span style="color: brown;">.</span><span style="color: navy;">FLOAT</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"b"</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">DtypeKind</span><span style="color: brown;">.</span><span style="color: navy;">BOOL</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"U"</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">DtypeKind</span><span style="color: brown;">.</span><span style="color: navy;">STRING</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"M"</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">DtypeKind</span><span style="color: brown;">.</span><span style="color: navy;">DATETIME</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"m"</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">DtypeKind</span><span style="color: brown;">.</span><span style="color: navy;">DATETIME</span><span style="color: brown;">,</span><br><span style="color: brown;">}</span><br><br><span style="color: navy;">_NULL_DESCRIPTION</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: brown;">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">DtypeKind</span><span style="color: brown;">.</span><span style="color: navy;">FLOAT</span><span style="color: brown;">:</span>&nbsp;<span style="color: brown;">(</span><span style="color: navy;">ColumnNullType</span><span style="color: brown;">.</span><span style="color: navy;">USE_NAN</span><span style="color: brown;">,</span>&nbsp;<span style="color: purple;">None</span><span style="color: brown;">)</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">DtypeKind</span><span style="color: brown;">.</span><span style="color: navy;">DATETIME</span><span style="color: brown;">:</span>&nbsp;<span style="color: brown;">(</span><span style="color: navy;">ColumnNullType</span><span style="color: brown;">.</span><span style="color: navy;">USE_SENTINEL</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">iNaT</span><span style="color: brown;">)</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">DtypeKind</span><span style="color: brown;">.</span><span style="color: navy;">INT</span><span style="color: brown;">:</span>&nbsp;<span style="color: brown;">(</span><span style="color: navy;">ColumnNullType</span><span style="color: brown;">.</span><span style="color: navy;">NON_NULLABLE</span><span style="color: brown;">,</span>&nbsp;<span style="color: purple;">None</span><span style="color: brown;">)</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">DtypeKind</span><span style="color: brown;">.</span><span style="color: navy;">UINT</span><span style="color: brown;">:</span>&nbsp;<span style="color: brown;">(</span><span style="color: navy;">ColumnNullType</span><span style="color: brown;">.</span><span style="color: navy;">NON_NULLABLE</span><span style="color: brown;">,</span>&nbsp;<span style="color: purple;">None</span><span style="color: brown;">)</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">DtypeKind</span><span style="color: brown;">.</span><span style="color: navy;">BOOL</span><span style="color: brown;">:</span>&nbsp;<span style="color: brown;">(</span><span style="color: navy;">ColumnNullType</span><span style="color: brown;">.</span><span style="color: navy;">NON_NULLABLE</span><span style="color: brown;">,</span>&nbsp;<span style="color: purple;">None</span><span style="color: brown;">)</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># Null values for categoricals are stored as `-1` sentinel values</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># in the category date (e.g., `col.values.codes` is int8 np.ndarray)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">DtypeKind</span><span style="color: brown;">.</span><span style="color: navy;">CATEGORICAL</span><span style="color: brown;">:</span>&nbsp;<span style="color: brown;">(</span><span style="color: navy;">ColumnNullType</span><span style="color: brown;">.</span><span style="color: navy;">USE_SENTINEL</span><span style="color: brown;">,</span>&nbsp;<span style="color: orange;">-</span><span style="color: blue;">1</span><span style="color: brown;">)</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># follow Arrow in using 1 as valid value and 0 for missing/null value</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">DtypeKind</span><span style="color: brown;">.</span><span style="color: navy;">STRING</span><span style="color: brown;">:</span>&nbsp;<span style="color: brown;">(</span><span style="color: navy;">ColumnNullType</span><span style="color: brown;">.</span><span style="color: navy;">USE_BYTEMASK</span><span style="color: brown;">,</span>&nbsp;<span style="color: blue;">0</span><span style="color: brown;">)</span><span style="color: brown;">,</span><br><span style="color: brown;">}</span><br><br><span style="color: navy;">_NO_VALIDITY_BUFFER</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: brown;">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">ColumnNullType</span><span style="color: brown;">.</span><span style="color: navy;">NON_NULLABLE</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"This column is non-nullable"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">ColumnNullType</span><span style="color: brown;">.</span><span style="color: navy;">USE_NAN</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"This column uses NaN as null"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">ColumnNullType</span><span style="color: brown;">.</span><span style="color: navy;">USE_SENTINEL</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"This column uses a sentinel value"</span><span style="color: brown;">,</span><br><span style="color: brown;">}</span><br><br><br><span style="color: purple;">class</span>&nbsp;<span style="color: olive;">PandasColumn</span><span style="color: brown;">(</span><span style="color: navy;">Column</span><span style="color: brown;">)</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">""</span><span style="color: green;">"
    A column object, with only the methods and properties required by the
    interchange protocol defined.
    A column can contain one or more chunks. Each chunk can contain up to three
    buffers - a data buffer, a mask buffer (depending on null representation),
    and an offsets buffer (if variable-size binary; e.g., variable-length
    strings).
    Note: this Column object can only be produced by ``__dataframe__``, so
          doesn't need its own version or ``__column__`` protocol.
    "</span><span style="color: green;">""</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">def</span>&nbsp;<span style="color: purple;">__init__</span><span style="color: brown;">(</span><span style="color: navy;">self</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">column</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">pd</span><span style="color: brown;">.</span><span style="color: navy;">Series</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">allow_copy</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">bool</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: purple;">True</span><span style="color: brown;">)</span>&nbsp;<span style="color: orange;">-</span><span style="color: orange;">></span>&nbsp;<span style="color: purple;">None</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">""</span><span style="color: green;">"
        Note: doesn't deal with extension arrays yet, just assume a regular
        Series/ndarray for now.
        "</span><span style="color: green;">""</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: olive;">isinstance</span><span style="color: brown;">(</span><span style="color: navy;">column</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">pd</span><span style="color: brown;">.</span><span style="color: navy;">DataFrame</span><span style="color: brown;">)</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">raise</span>&nbsp;<span style="color: purple;">TypeError</span><span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"Expected a Series, got a DataFrame. This likely happened "</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"because you called __dataframe__ on a DataFrame which, "</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"after converting column names to string, resulted in duplicated "</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">f</span><span style="color: green;">"names: {column.columns}. Please rename these columns before "</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"using the interchange protocol."</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: purple;">not</span>&nbsp;<span style="color: olive;">isinstance</span><span style="color: brown;">(</span><span style="color: navy;">column</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">pd</span><span style="color: brown;">.</span><span style="color: navy;">Series</span><span style="color: brown;">)</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">raise</span>&nbsp;<span style="color: purple;">NotImplementedError</span><span style="color: brown;">(</span><span style="color: navy;">f</span><span style="color: green;">"Columns of type {type(column)} not handled yet"</span><span style="color: brown;">)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># Store the column as a private attribute</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">self</span><span style="color: brown;">.</span><span style="color: navy;">_col</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: navy;">column</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">self</span><span style="color: brown;">.</span><span style="color: navy;">_allow_copy</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: navy;">allow_copy</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">def</span>&nbsp;<span style="color: olive;">size</span><span style="color: brown;">(</span><span style="color: navy;">self</span><span style="color: brown;">)</span>&nbsp;<span style="color: orange;">-</span><span style="color: orange;">></span>&nbsp;<span style="color: navy;">int</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">""</span><span style="color: green;">"
        Size of the column, in elements.
        "</span><span style="color: green;">""</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">self</span><span style="color: brown;">.</span><span style="color: navy;">_col</span><span style="color: brown;">.</span><span style="color: navy;">size</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;
</pre></body>
</html>