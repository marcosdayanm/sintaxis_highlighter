<!DOCTYPE html>
<html>
<head>
<title>Highlighted Code</title>
</head>
<body>
<div><h2>Gu√≠a de Colores</h2><ul><li><span style="color: red;">Error</span></li><li><span style="color: blue;">Numbers</span></li><li><span style="color: orange;">Operators</span></li><li><span style="color: navy;">Variables</span></li><li><span style="color: olive;">Functions</span></li><li><span style="color: purple;">Reserved</span></li><li><span style="color: green;">String</span></li><li><span style="color: silver;">Comments</span></li><li><span style="color: brown;">Keys_brackets_punctuation</span></li><li><span style="color: black;">Format</span></li></ul></div><hr><pre>
<span style="color: green;">""</span><span style="color: green;">"
Utility functions and objects for implementing the interchange API.
"</span><span style="color: green;">""</span><br><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">__future__</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">annotations</span><br><br><span style="color: purple;">import</span>&nbsp;<span style="color: navy;">typing</span><br><br><span style="color: purple;">import</span>&nbsp;<span style="color: navy;">numpy</span>&nbsp;<span style="color: purple;">as</span>&nbsp;<span style="color: navy;">np</span><br><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">_libs</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">lib</span><br><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">dtypes</span><span style="color: brown;">.</span><span style="color: navy;">dtypes</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">ArrowDtype</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">CategoricalDtype</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">DatetimeTZDtype</span><span style="color: brown;">,</span><br><span style="color: brown;">)</span><br><br><span style="color: purple;">import</span>&nbsp;<span style="color: navy;">pandas</span>&nbsp;<span style="color: purple;">as</span>&nbsp;<span style="color: navy;">pd</span><br><br><span style="color: purple;">if</span>&nbsp;<span style="color: navy;">typing</span><span style="color: brown;">.</span><span style="color: navy;">TYPE_CHECKING</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">_typing</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">DtypeObj</span><br><br><br><span style="color: silver;"># Maps str(pyarrow.DataType) = C type format string</span><br><span style="color: silver;"># Currently, no pyarrow API for this</span><br><span style="color: navy;">PYARROW_CTYPES</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: brown;">{</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"null"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"n"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"bool"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"b"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"uint8"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"C"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"uint16"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"S"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"uint32"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"I"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"uint64"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"L"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"int8"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"c"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"int16"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"S"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"int32"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"i"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"int64"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"l"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"halffloat"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"e"</span><span style="color: brown;">,</span>&nbsp;&nbsp;<span style="color: silver;"># float16</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"float"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"f"</span><span style="color: brown;">,</span>&nbsp;&nbsp;<span style="color: silver;"># float32</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"double"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"g"</span><span style="color: brown;">,</span>&nbsp;&nbsp;<span style="color: silver;"># float64</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"string"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"u"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"large_string"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"U"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"binary"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"z"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"time32[s]"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"tts"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"time32[ms]"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"ttm"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"time64[us]"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"ttu"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"time64[ns]"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"ttn"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"date32[day]"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"tdD"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"date64[ms]"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"tdm"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"timestamp[s]"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"tss:"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"timestamp[ms]"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"tsm:"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"timestamp[us]"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"tsu:"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"timestamp[ns]"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"tsn:"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"duration[s]"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"tDs"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"duration[ms]"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"tDm"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"duration[us]"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"tDu"</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">"duration[ns]"</span><span style="color: brown;">:</span>&nbsp;<span style="color: green;">"tDn"</span><span style="color: brown;">,</span><br><span style="color: brown;">}</span><br><br><br><span style="color: purple;">class</span>&nbsp;<span style="color: navy;">ArrowCTypes</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">""</span><span style="color: green;">"
    Enum for Apache Arrow C type format strings.

    The Arrow C data interface:
    https://arrow.apache.org/docs/format/CDataInterface.html#data-type-description-format-strings
    "</span><span style="color: green;">""</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">NULL</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"n"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">BOOL</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"b"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">INT8</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"c"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">UINT8</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"C"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">INT16</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"s"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">UINT16</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"S"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">INT32</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"i"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">UINT32</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"I"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">INT64</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"l"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">UINT64</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"L"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">FLOAT16</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"e"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">FLOAT32</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"f"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">FLOAT64</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"g"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">STRING</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"u"</span>&nbsp;&nbsp;<span style="color: silver;"># utf-8</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">LARGE_STRING</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"U"</span>&nbsp;&nbsp;<span style="color: silver;"># utf-8</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">DATE32</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"tdD"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">DATE64</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"tdm"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># Resoulution:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;">#   - seconds -> 's'</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;">#   - milliseconds -> 'm'</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;">#   - microseconds -> 'u'</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;">#   - nanoseconds -> 'n'</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">TIMESTAMP</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"ts{resolution}:{tz}"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">TIME</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"tt{resolution}"</span><br><br><br><span style="color: purple;">class</span>&nbsp;<span style="color: navy;">Endianness</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">""</span><span style="color: green;">"Enum indicating the byte-order of a data-type."</span><span style="color: green;">""</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">LITTLE</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"<"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">BIG</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">">"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">NATIVE</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"="</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">NA</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: green;">"|"</span><br><br><br><span style="color: purple;">def</span>&nbsp;<span style="color: olive;">dtype_to_arrow_c_fmt</span><span style="color: brown;">(</span><span style="color: navy;">dtype</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">DtypeObj</span><span style="color: brown;">)</span>&nbsp;<span style="color: orange;">-</span><span style="color: orange;">></span>&nbsp;<span style="color: navy;">str</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">""</span><span style="color: green;">"
    Represent pandas `dtype` as a format string in Apache Arrow C notation.

    Parameters
    ----------
    dtype : np.dtype
        Datatype of pandas DataFrame to represent.

    Returns
    -------
    str
        Format string in Apache Arrow C notation of the given `dtype`.
    "</span><span style="color: green;">""</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: olive;">isinstance</span><span style="color: brown;">(</span><span style="color: navy;">dtype</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">CategoricalDtype</span><span style="color: brown;">)</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">ArrowCTypes</span><span style="color: brown;">.</span><span style="color: navy;">INT64</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">elif</span>&nbsp;<span style="color: navy;">dtype</span>&nbsp;<span style="color: orange;">=</span><span style="color: orange;">=</span>&nbsp;<span style="color: navy;">np</span><span style="color: brown;">.</span><span style="color: olive;">dtype</span><span style="color: brown;">(</span><span style="color: green;">"O"</span><span style="color: brown;">)</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">ArrowCTypes</span><span style="color: brown;">.</span><span style="color: navy;">STRING</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">elif</span>&nbsp;<span style="color: olive;">isinstance</span><span style="color: brown;">(</span><span style="color: navy;">dtype</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">ArrowDtype</span><span style="color: brown;">)</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">pyarrow</span>&nbsp;<span style="color: purple;">as</span>&nbsp;<span style="color: navy;">pa</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">pa_type</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: navy;">dtype</span><span style="color: brown;">.</span><span style="color: navy;">pyarrow_dtype</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: navy;">pa</span><span style="color: brown;">.</span><span style="color: navy;">types</span><span style="color: brown;">.</span><span style="color: olive;">is_decimal</span><span style="color: brown;">(</span><span style="color: navy;">pa_type</span><span style="color: brown;">)</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">f</span><span style="color: green;">"d:{pa_type.precision},{pa_type.scale}"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">elif</span>&nbsp;<span style="color: navy;">pa</span><span style="color: brown;">.</span><span style="color: navy;">types</span><span style="color: brown;">.</span><span style="color: olive;">is_timestamp</span><span style="color: brown;">(</span><span style="color: navy;">pa_type</span><span style="color: brown;">)</span>&nbsp;<span style="color: purple;">and</span>&nbsp;<span style="color: navy;">pa_type</span><span style="color: brown;">.</span><span style="color: navy;">tz</span>&nbsp;<span style="color: purple;">is</span>&nbsp;<span style="color: purple;">not</span>&nbsp;<span style="color: purple;">None</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">f</span><span style="color: green;">"ts{pa_type.unit[0]}:{pa_type.tz}"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">format_str</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: navy;">PYARROW_CTYPES</span><span style="color: brown;">.</span><span style="color: olive;">get</span><span style="color: brown;">(</span><span style="color: olive;">str</span><span style="color: brown;">(</span><span style="color: navy;">pa_type</span><span style="color: brown;">)</span><span style="color: brown;">,</span>&nbsp;<span style="color: purple;">None</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: navy;">format_str</span>&nbsp;<span style="color: purple;">is</span>&nbsp;<span style="color: purple;">not</span>&nbsp;<span style="color: purple;">None</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">format_str</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">format_str</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">getattr</span><span style="color: brown;">(</span><span style="color: navy;">ArrowCTypes</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">dtype</span><span style="color: brown;">.</span><span style="color: navy;">name</span><span style="color: brown;">.</span><span style="color: olive;">upper</span><span style="color: brown;">(</span><span style="color: brown;">)</span><span style="color: brown;">,</span>&nbsp;<span style="color: purple;">None</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: navy;">format_str</span>&nbsp;<span style="color: purple;">is</span>&nbsp;<span style="color: purple;">not</span>&nbsp;<span style="color: purple;">None</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">format_str</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: navy;">lib</span><span style="color: brown;">.</span><span style="color: olive;">is_np_dtype</span><span style="color: brown;">(</span><span style="color: navy;">dtype</span><span style="color: brown;">,</span>&nbsp;<span style="color: green;">"M"</span><span style="color: brown;">)</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># Selecting the first char of resolution string:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># dtype.str -> '<M8[ns]' -> 'n'</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">resolution</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: navy;">np</span><span style="color: brown;">.</span><span style="color: olive;">datetime_data</span><span style="color: brown;">(</span><span style="color: navy;">dtype</span><span style="color: brown;">)</span><span style="color: brown;">[</span><span style="color: blue;">0</span><span style="color: brown;">]</span><span style="color: brown;">[</span><span style="color: blue;">0</span><span style="color: brown;">]</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">ArrowCTypes</span><span style="color: brown;">.</span><span style="color: navy;">TIMESTAMP</span><span style="color: brown;">.</span><span style="color: olive;">format</span><span style="color: brown;">(</span><span style="color: navy;">resolution</span><span style="color: orange;">=</span><span style="color: navy;">resolution</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">tz</span><span style="color: orange;">=</span><span style="color: green;">""</span><span style="color: brown;">)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">elif</span>&nbsp;<span style="color: olive;">isinstance</span><span style="color: brown;">(</span><span style="color: navy;">dtype</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">DatetimeTZDtype</span><span style="color: brown;">)</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">ArrowCTypes</span><span style="color: brown;">.</span><span style="color: navy;">TIMESTAMP</span><span style="color: brown;">.</span><span style="color: olive;">format</span><span style="color: brown;">(</span><span style="color: navy;">resolution</span><span style="color: orange;">=</span><span style="color: navy;">dtype</span><span style="color: brown;">.</span><span style="color: olive;">unit</span><span style="color: brown;">[</span><span style="color: blue;">0</span><span style="color: brown;">]</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">tz</span><span style="color: orange;">=</span><span style="color: navy;">dtype</span><span style="color: brown;">.</span><span style="color: navy;">tz</span><span style="color: brown;">)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">elif</span>&nbsp;<span style="color: olive;">isinstance</span><span style="color: brown;">(</span><span style="color: navy;">dtype</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">pd</span><span style="color: brown;">.</span><span style="color: navy;">BooleanDtype</span><span style="color: brown;">)</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">ArrowCTypes</span><span style="color: brown;">.</span><span style="color: navy;">BOOL</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">raise</span>&nbsp;<span style="color: purple;">NotImplementedError</span><span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">f</span><span style="color: green;">"Conversion of {dtype} to Arrow C format string is not implemented."</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: brown;">)</span><br><br><br><span style="color: purple;">def</span>&nbsp;<span style="color: olive;">maybe_rechunk</span><span style="color: brown;">(</span><span style="color: navy;">series</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">pd</span><span style="color: brown;">.</span><span style="color: navy;">Series</span><span style="color: brown;">,</span>&nbsp;<span style="color: red;">*,</span>&nbsp;<span style="color: navy;">allow_copy</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">bool</span><span style="color: brown;">)</span>&nbsp;<span style="color: orange;">-</span><span style="color: orange;">></span>&nbsp;<span style="color: navy;">pd</span><span style="color: brown;">.</span><span style="color: navy;">Series</span>&nbsp;
</pre></body>
</html>