<!DOCTYPE html>
<html>
<head>
<title>Highlighted Code</title>
</head>
<body>
<div><h2>Gu√≠a de Colores</h2><ul><li><span style="color: red;">Error</span></li><li><span style="color: blue;">Numbers</span></li><li><span style="color: orange;">Operators</span></li><li><span style="color: navy;">Variables</span></li><li><span style="color: olive;">Functions</span></li><li><span style="color: purple;">Reserved</span></li><li><span style="color: green;">String</span></li><li><span style="color: silver;">Comments</span></li><li><span style="color: brown;">Keys_brackets_punctuation</span></li><li><span style="color: black;">Format</span></li></ul></div><hr><pre>
<span style="color: green;">""</span><span style="color: green;">"
Utility functions related to concat.
"</span><span style="color: green;">""</span><br><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">__future__</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">annotations</span><br><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">typing</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">TYPE_CHECKING</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">cast</span><span style="color: brown;">,</span><br><span style="color: brown;">)</span><br><br><span style="color: purple;">import</span>&nbsp;<span style="color: navy;">numpy</span>&nbsp;<span style="color: purple;">as</span>&nbsp;<span style="color: navy;">np</span><br><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">_libs</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">lib</span><br><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">dtypes</span><span style="color: brown;">.</span><span style="color: navy;">astype</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">astype_array</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">dtypes</span><span style="color: brown;">.</span><span style="color: navy;">cast</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">common_dtype_categorical_compat</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">find_common_type</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">np_find_common_type</span><span style="color: brown;">,</span><br><span style="color: brown;">)</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">dtypes</span><span style="color: brown;">.</span><span style="color: navy;">dtypes</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">CategoricalDtype</span><br><span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">dtypes</span><span style="color: brown;">.</span><span style="color: navy;">generic</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">ABCCategoricalIndex</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">ABCSeries</span><span style="color: brown;">,</span><br><span style="color: brown;">)</span><br><br><span style="color: purple;">if</span>&nbsp;<span style="color: navy;">TYPE_CHECKING</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">from</span>&nbsp;<span style="color: navy;">collections</span><span style="color: brown;">.</span><span style="color: navy;">abc</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: navy;">Sequence</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">_typing</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">ArrayLike</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">AxisInt</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">DtypeObj</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: brown;">)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">from</span>&nbsp;<span style="color: navy;">pandas</span><span style="color: brown;">.</span><span style="color: navy;">core</span><span style="color: brown;">.</span><span style="color: navy;">arrays</span>&nbsp;<span style="color: purple;">import</span>&nbsp;<span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">Categorical</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">ExtensionArray</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: brown;">)</span><br><br><br><span style="color: purple;">def</span>&nbsp;<span style="color: olive;">_is_nonempty</span><span style="color: brown;">(</span><span style="color: navy;">x</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">ArrayLike</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">axis</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">AxisInt</span><span style="color: brown;">)</span>&nbsp;<span style="color: orange;">-</span><span style="color: orange;">></span>&nbsp;<span style="color: navy;">bool</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># filter empty arrays</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># 1-d dtypes always are included here</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: navy;">x</span><span style="color: brown;">.</span><span style="color: navy;">ndim</span>&nbsp;<span style="color: black;"><</span><span style="color: orange;">=</span>&nbsp;<span style="color: navy;">axis</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: purple;">True</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">x</span><span style="color: brown;">.</span><span style="color: olive;">shape</span><span style="color: brown;">[</span><span style="color: navy;">axis</span><span style="color: brown;">]</span>&nbsp;<span style="color: orange;">></span>&nbsp;<span style="color: blue;">0</span><br><br><br><span style="color: purple;">def</span>&nbsp;<span style="color: olive;">concat_compat</span><span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">to_concat</span><span style="color: brown;">:</span>&nbsp;<span style="color: olive;">Sequence</span><span style="color: brown;">[</span><span style="color: navy;">ArrayLike</span><span style="color: brown;">]</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">axis</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">AxisInt</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: blue;">0</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">ea_compat_axis</span><span style="color: brown;">:</span>&nbsp;<span style="color: navy;">bool</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: purple;">False</span><br><span style="color: brown;">)</span>&nbsp;<span style="color: orange;">-</span><span style="color: orange;">></span>&nbsp;<span style="color: navy;">ArrayLike</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: green;">""</span><span style="color: green;">"
    provide concatenation of an array of arrays each of which is a single
    'normalized' dtypes (in that for example, if it's object, then it is a
    non-datetimelike and provide a combined dtype for the resulting array that
    preserves the overall dtype if possible)

    Parameters
    ----------
    to_concat : sequence of arrays
    axis : axis to provide concatenation
    ea_compat_axis : bool, default False
        For ExtensionArray compat, behave as if axis == 1 when determining
        whether to drop empty arrays.

    Returns
    -------
    a single array, preserving the combined dtypes
    "</span><span style="color: green;">""</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: olive;">len</span><span style="color: brown;">(</span><span style="color: navy;">to_concat</span><span style="color: brown;">)</span>&nbsp;<span style="color: purple;">and</span>&nbsp;<span style="color: navy;">lib</span><span style="color: brown;">.</span><span style="color: olive;">dtypes_all_equal</span><span style="color: brown;">(</span><span style="color: brown;">[</span><span style="color: navy;">obj</span><span style="color: brown;">.</span><span style="color: navy;">dtype</span>&nbsp;<span style="color: purple;">for</span>&nbsp;<span style="color: navy;">obj</span>&nbsp;<span style="color: purple;">in</span>&nbsp;<span style="color: navy;">to_concat</span><span style="color: brown;">]</span><span style="color: brown;">)</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># fastpath!</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">obj</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">to_concat</span><span style="color: brown;">[</span><span style="color: blue;">0</span><span style="color: brown;">]</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: olive;">isinstance</span><span style="color: brown;">(</span><span style="color: navy;">obj</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">np</span><span style="color: brown;">.</span><span style="color: navy;">ndarray</span><span style="color: brown;">)</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">to_concat_arrs</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">cast</span><span style="color: brown;">(</span><span style="color: green;">"Sequence[np.ndarray]"</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">to_concat</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">np</span><span style="color: brown;">.</span><span style="color: olive;">concatenate</span><span style="color: brown;">(</span><span style="color: navy;">to_concat_arrs</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">axis</span><span style="color: orange;">=</span><span style="color: navy;">axis</span><span style="color: brown;">)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">to_concat_eas</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">cast</span><span style="color: brown;">(</span><span style="color: green;">"Sequence[ExtensionArray]"</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">to_concat</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: navy;">ea_compat_axis</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># We have 1D objects, that don't support axis keyword</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">obj</span><span style="color: brown;">.</span><span style="color: olive;">_concat_same_type</span><span style="color: brown;">(</span><span style="color: navy;">to_concat_eas</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">elif</span>&nbsp;<span style="color: navy;">axis</span>&nbsp;<span style="color: orange;">=</span><span style="color: orange;">=</span>&nbsp;<span style="color: blue;">0</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">obj</span><span style="color: brown;">.</span><span style="color: olive;">_concat_same_type</span><span style="color: brown;">(</span><span style="color: navy;">to_concat_eas</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">else</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># e.g. DatetimeArray</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># NB: We are assuming here that ensure_wrapped_if_arraylike has</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;">#  been called where relevant.</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">obj</span><span style="color: brown;">.</span><span style="color: olive;">_concat_same_type</span><span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># error: Unexpected keyword argument "axis" for "_concat_same_type"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># of "ExtensionArray"</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">to_concat_eas</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">axis</span><span style="color: orange;">=</span><span style="color: navy;">axis</span><span style="color: brown;">,</span>&nbsp;&nbsp;<span style="color: silver;"># type: ignore[call-arg]</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: brown;">)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># If all arrays are empty, there's nothing to convert, just short-cut to</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># the concatenation, #3121.</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;">#</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># Creating an empty array directly is tempting, but the winnings would be</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># marginal given that it would still require shape & dtype calculation and</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># np.concatenate which has them both implemented is compiled.</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">non_empties</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: brown;">[</span><span style="color: navy;">x</span>&nbsp;<span style="color: purple;">for</span>&nbsp;<span style="color: navy;">x</span>&nbsp;<span style="color: purple;">in</span>&nbsp;<span style="color: navy;">to_concat</span>&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: olive;">_is_nonempty</span><span style="color: brown;">(</span><span style="color: navy;">x</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">axis</span><span style="color: brown;">)</span><span style="color: brown;">]</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">any_ea</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">kinds</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">target_dtype</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">_get_result_dtype</span><span style="color: brown;">(</span><span style="color: navy;">to_concat</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">non_empties</span><span style="color: brown;">)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: navy;">target_dtype</span>&nbsp;<span style="color: purple;">is</span>&nbsp;<span style="color: purple;">not</span>&nbsp;<span style="color: purple;">None</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">to_concat</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: brown;">[</span><span style="color: olive;">astype_array</span><span style="color: brown;">(</span><span style="color: navy;">arr</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">target_dtype</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">copy</span><span style="color: orange;">=</span><span style="color: purple;">False</span><span style="color: brown;">)</span>&nbsp;<span style="color: purple;">for</span>&nbsp;<span style="color: navy;">arr</span>&nbsp;<span style="color: purple;">in</span>&nbsp;<span style="color: navy;">to_concat</span><span style="color: brown;">]</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: purple;">not</span>&nbsp;<span style="color: olive;">isinstance</span><span style="color: brown;">(</span><span style="color: olive;">to_concat</span><span style="color: brown;">[</span><span style="color: blue;">0</span><span style="color: brown;">]</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">np</span><span style="color: brown;">.</span><span style="color: navy;">ndarray</span><span style="color: brown;">)</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># i.e. isinstance(to_concat[0], ExtensionArray)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">to_concat_eas</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">cast</span><span style="color: brown;">(</span><span style="color: green;">"Sequence[ExtensionArray]"</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">to_concat</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">cls</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">type</span><span style="color: brown;">(</span><span style="color: olive;">to_concat</span><span style="color: brown;">[</span><span style="color: blue;">0</span><span style="color: brown;">]</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># GH#53640: eg. for datetime array, axis=1 but 0 is default</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># However, class method `_concat_same_type()` for some classes</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># may not support the `axis` keyword</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: navy;">ea_compat_axis</span>&nbsp;<span style="color: purple;">or</span>&nbsp;<span style="color: navy;">axis</span>&nbsp;<span style="color: orange;">=</span><span style="color: orange;">=</span>&nbsp;<span style="color: blue;">0</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">cls</span><span style="color: brown;">.</span><span style="color: olive;">_concat_same_type</span><span style="color: brown;">(</span><span style="color: navy;">to_concat_eas</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">else</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">cls</span><span style="color: brown;">.</span><span style="color: olive;">_concat_same_type</span><span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">to_concat_eas</span><span style="color: brown;">,</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">axis</span><span style="color: orange;">=</span><span style="color: navy;">axis</span><span style="color: brown;">,</span>&nbsp;&nbsp;<span style="color: silver;"># type: ignore[call-arg]</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">else</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">to_concat_arrs</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: olive;">cast</span><span style="color: brown;">(</span><span style="color: green;">"Sequence[np.ndarray]"</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">to_concat</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">result</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: navy;">np</span><span style="color: brown;">.</span><span style="color: olive;">concatenate</span><span style="color: brown;">(</span><span style="color: navy;">to_concat_arrs</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">axis</span><span style="color: orange;">=</span><span style="color: navy;">axis</span><span style="color: brown;">)</span><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">if</span>&nbsp;<span style="color: purple;">not</span>&nbsp;<span style="color: navy;">any_ea</span>&nbsp;<span style="color: purple;">and</span>&nbsp;<span style="color: green;">"b"</span>&nbsp;<span style="color: purple;">in</span>&nbsp;<span style="color: navy;">kinds</span>&nbsp;<span style="color: purple;">and</span>&nbsp;<span style="color: navy;">result</span><span style="color: brown;">.</span><span style="color: navy;">dtype</span><span style="color: brown;">.</span><span style="color: navy;">kind</span>&nbsp;<span style="color: purple;">in</span>&nbsp;<span style="color: green;">"iuf"</span><span style="color: brown;">:</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: silver;"># GH#39817 cast to object instead of casting bools to numeric</span><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">result</span>&nbsp;<span style="color: orange;">=</span>&nbsp;<span style="color: navy;">result</span><span style="color: brown;">.</span><span style="color: olive;">astype</span><span style="color: brown;">(</span><span style="color: navy;">object</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">copy</span><span style="color: orange;">=</span><span style="color: purple;">False</span><span style="color: brown;">)</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: purple;">return</span>&nbsp;<span style="color: navy;">result</span><br><br><br><span style="color: purple;">def</span>&nbsp;<span style="color: olive;">_get_result_dtype</span><span style="color: brown;">(</span><br>&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: navy;">to_concat</span><span style="color: brown;">:</span>&nbsp;<span style="color: olive;">Sequence</span><span style="color: brown;">[</span><span style="color: navy;">ArrayLike</span><span style="color: brown;">]</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">non_empties</span><span style="color: brown;">:</span>&nbsp;<span style="color: olive;">Sequence</span><span style="color: brown;">[</span><span style="color: navy;">ArrayLike</span><span style="color: brown;">]</span><br><span style="color: brown;">)</span>&nbsp;<span style="color: orange;">-</span><span style="color: orange;">></span>&nbsp;<span style="color: olive;">tuple</span><span style="color: brown;">[</span><span style="color: navy;">bool</span><span style="color: brown;">,</span>&nbsp;<span style="color: olive;">set</span><span style="color: brown;">[</span><span style="color: navy;">str</span><span style="color: brown;">]</span><span style="color: brown;">,</span>&nbsp;<span style="color: navy;">DtypeObj</span>&nbsp;
</pre></body>
</html>